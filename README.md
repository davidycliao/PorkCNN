# PorkCNN  ğŸ–ğŸ–ğŸ–
A Small Project for Pork Barrel Legislation  Classification Using Convolutional Neural Networks 


## Enviroment Setting

- Python 3.8 
- tensorflow==2.5.0
- numpy
- scikit-learn
- scipy 



### Original Trianing Textual Data (Pork Barrel Legislation)

``` 
        text	                                         pork_bill
0	è»äººæ’«å¹æ¢ä¾‹ç¬¬åå…«æ¢æ¢æ–‡ä¿®æ­£è‰æ¡ˆè½å¯¦è»äººåŠçœ·å±¬ä¹‹ç…§é¡§...   1
1	æ‰€å¾—ç¨…æ³•ç¬¬åä¸ƒæ¢æ¢æ–‡ä¿®æ­£è‰æ¡ˆå­¸è²»ä¹‹ç‰¹åˆ¥æ‰£é™¤é¡æ‡‰ä»¥æ¯äºº...   1
2	æ‰€å¾—ç¨…æ³•ç¬¬åä¸€æ¢æ¢æ–‡ä¿®æ­£è‰æ¡ˆä¿éšªäººå“¡ç”³å ±æ™‚å¾—æ‰£é™¤ä¸€å®š...   1
3	åœŸåœ°ç¨…æ³•ç¬¬äºŒåå…«æ¢ä¹‹ä¸€æ¢æ–‡ä¿®æ­£è‰æ¡ˆåœŸåœ°è´ˆèˆ‡æ–‡æ•™åŸºé‡‘æœƒ...   1
4	æ•¬è€ç¦åˆ©ç”Ÿæ´»æ´¥è²¼æš«è¡Œæ¢ä¾‹ç¬¬ä¸‰æ¢æ¢æ–‡ä¿®æ­£è‰æ¡ˆæ”¾å¯¬è«‹é ˜è³‡...   1
5	æ´—éŒ¢é˜²åˆ¶æ³•éƒ¨åˆ†æ¢æ–‡ä¿®æ­£è‰æ¡ˆçµ¦äºˆæ³•å®˜è¼ƒå¤§æ¬Šé™ï¼›èµ·è¨´æœŸé–“...	 0
6	æ—¥æ“šæ™‚ä»£æ—¥æœ¬æ”¿åºœåœ‹åº«åˆ¸åŠå‚µåˆ¸è™•ç†æ¢ä¾‹è‰æ¡ˆå°±æ˜¯ä¿éšœæ—¥æ“š...	 0
7	å¤§é™¸åœ°å€äººæ°‘ä¾†è‡ºå¾äº‹è§€å…‰æ´»å‹•æ¢ä¾‹è‰æ¡ˆé–‹æ”¾å¤§é™¸äººæ°‘è§€å…‰...	 0
8	é™åˆ¶æ¬ ç¨…äººæˆ–æ¬ ç¨…ç‡Ÿåˆ©äº‹æ¥­è² è²¬äººå‡ºå¢ƒå¯¦æ–½æ¢ä¾‹è‰æ¡ˆç¾è¡Œæ³•...	 0
9	ä½¿ç”¨ç‰Œç…§ç¨…æ³•ç¬¬ä¸ƒæ¢æ¢æ–‡ä¿®æ­£è‰æ¡ˆæ°‘ç‡Ÿæ±½è»Šé§•é§›äººè¨“ç·´æ©Ÿæ§‹...	 1

```

### Num of Train/ Test Split

```
Num of Train Set: 797 
Not Pork vs Pork: {0: 527, 1: 270}

Num of Test Set: 394 
Not Pork vs Pork: {0: 265, 1: 129}
```

### Model Building & Specification

```
Model: "dcnn"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        multiple                  363800    
_________________________________________________________________
conv1d (Conv1D)              multiple                  40100     
_________________________________________________________________
conv1d_1 (Conv1D)            multiple                  60100     
_________________________________________________________________
conv1d_2 (Conv1D)            multiple                  80100     
_________________________________________________________________
global_max_pooling1d (Global multiple                  0         
_________________________________________________________________
dense (Dense)                multiple                  77056     
_________________________________________________________________
dropout (Dropout)            multiple                  0         
_________________________________________________________________
dense_1 (Dense)              multiple                  257       
=================================================================
Total params: 621,413
Trainable params: 621,413
Non-trainable params: 0
_________________________________________________________________
```



### Evaluation & Classification 

Training conntext: number of pork legislation 792; none-Pork is 399. 

```
                precision    recall  f1-score   support

        Pork       0.92      0.95      0.94       265
    Not Pork       0.90      0.82      0.86       129

    accuracy                           0.91       394
   macro avg       0.91      0.89      0.90       394
weighted avg       0.91      0.91      0.91       394
```
So I need more data to train/test. ğŸ˜¥

```
                     Prediction: Not Pork(0)	   Prediction: Pork(1)
Acutal: Not Pork(0)	                251	                   14
Acutal:    Pork (1)	                 25	                  104
```


### Application on New Dataset (200 Sampled Legislative Questions)

#### Top 5 of 200 Samples

| Pork/Constituency Interest |      Legislative Questions   |  Topic |  Key Word |
|:----------:|:-------------:|:------:|:------:|
|0.811236739158630|	é‡å°æ”¿åºœå…¬æ•™è²¸æ¬¾åˆ©ç‡é«˜æ–¼ä¸€èˆ¬å•†æ¥­éŠ€è¡Œå°ˆæ¡ˆè¾¦ç†ä¹‹æˆ¿å±‹è²¸æ¬¾åˆ©ç‡ï¼Œä½¿å…¬æ•™äººå“¡ä¹‹æˆ¿è²¸åˆ©æ¯è² æ“”æ²ˆé‡ä¾èˆŠ...|	å…¬å‹™å“¡ç¦åˆ© ; æˆ¿å±‹è²¸æ¬¾ ; åˆ©ç‡|	å…¬æ•™è²¸æ¬¾åˆ©ç‡|
|0.443107038736343|	å—æŠ•ç¸£ç‚ºè¾²æ¥­ç¸£ä»½ï¼Œå·¥å•†ä¸ç™¼é”ï¼Œç¨…æ”¶è²¡æºä¸è±è£•ï¼Œå…¨å¹´åº¦è‡ªæœ‰è²¡æºæ”¶å…¥å°šä¸æ•·æ”¯æ‡‰å…¨ç¸£äººäº‹è²»æ”¯å‡ºï¼Œè€Œ...|	åœ°æ–¹è²¡æ”¿|	ç¨…æ”¶ ; åœ°æ–¹è²¡æ”¿
0.312157511711121 |	é‡å°ç›®å‰æ”¿åºœåä¸‰è¬è‡¨æ™‚äººå“¡å·²ä¾å‹é€€æ–°åˆ¶ææ’¥é€€ä¼‘é‡‘ï¼Œä½†ä»å°šæœªç´å…¥å‹åŸºæ³•ä¿éšœï¼Œæ”¿åºœæ‡‰å„˜é€Ÿå…¬å¸ƒå°‡è‡¨...|	å‹å‹•åŸºæº– ; è˜åƒ±äººå“¡ ; æ³•å¾‹é©ç”¨ç¯„åœ|	è‡¨æ™‚äººå“¡ ; å‹åŸºæ³•|
|0.247517079114914|	é‡å°è¿‘å¹´ä¾†è²¡å‹™æŒçºŒæƒ¡åŒ–çš„ä¸­å¤®å¥åº·ä¿éšªå±€ï¼Œåˆ©ç”¨å¥ä¿è²»çµ¦ä»˜éŠ€è¡Œå·¨é¡å€Ÿæ¬¾åˆ©æ¯è¡¨ç¤ºæ–¥è²¬ã€‚å¥ä¿å±€ç”¨æ°‘çœ¾...|	åœ‹æ°‘ ; å¥åº·ä¿éšª ; ä¿éšªè²»|	è²¡å‹™ ; ä¸­å¤®å¥åº·ä¿éšªå±€ ; å¥ä¿è²»çµ¦ä»˜|
|0.157373845577240|	é‡å°äº¤é€šéƒ¨ä¿®æ­£ã€Œé“è·¯äº¤é€šå®‰å…¨è¦å‰‡ã€ï¼Œå°‡å¤§å®¢è»Šã€è¯çµè»Šã€å¤§è²¨è»Šç­‰å¤§å‹è»Šè·æ¥­å¸æ©Ÿè€ƒç…§åŸ·æ¥­å¹´é½¡ä¸Šé™...|	é€€ä¼‘å¹´é½¡|	é“è·¯äº¤é€šå®‰å…¨è¦å‰‡ ; è·æ¥­å¸æ©Ÿ ; é€€ä¼‘å¹´é½¡|


&nbsp; 

#### Last 10 Rows of 200 Samples

| Pork/Constituency Interest |      Legislative Questions   |  Topic |  Key Word |
|:----------:|:-------------:|:------:|:------:|
|0.000001753699053|	é‡å°è¡Œæ”¿é™¢é‡‘èç›£ç£ç®¡ç†å§”å“¡æœƒï¼ˆé‡‘ç®¡æœƒï¼‰å®£ç¨±ï¼Œå°ç£ä¸Šå¸‚ä¸Šæ«ƒå…¬å¸æŠ•è³‡ä¸­åœ‹ç´¯è¨ˆåŒ¯å›è³‡é‡‘æ¯”ä¾‹é”7.9...|	å¤§é™¸æ”¿ç­– ; å°å¤–æŠ•è³‡	| æŠ•è³‡ä¸­åœ‹ ; å°å•†è³‡é‡‘åŒ¯å›|
|0.000001426775611|	å°±ç«‹å§”åŠç¸½çµ±é¸èˆ‰åœ¨å³ï¼Œç«‹å§”é¸èˆ‰åˆ¶åº¦é¦–æ¬¡æ¡è¡Œã€Œå–®ä¸€é¸å€å…©ç¥¨åˆ¶ã€ï¼Œé¸æƒ…ç·Šç¹ƒï¼Œè³„å½±é‡é‡ï¼Œç‚ºå…è³„é¸çŒ–...|	é¸èˆ‰é¢¨ç´€|	ç¸½çµ±é¸èˆ‰ ; ç«‹å§”é¸èˆ‰ ; è³„é¸|
|0.000001366255105|	é‡å°æ”¿åºœè‹¥å¹²å…¬å‹™äººå“¡æ¶‰å«Œé‡å¤§å¼Šæ¡ˆï¼Œè«¸å¦‚é«˜é›„æ·é‹å¼Šæ¡ˆã€è‚¡å¸‚ç¦¿é·¹æ¡ˆã€åœ‹é“é›»å­æ”¶è²»ï¼ˆETCï¼‰æ¡ˆï¼Œåš´...|	å…¬å‹™å“¡ ; è¡Œæ”¿ä¸­ç«‹ ; é»¨æ”¿é—œä¿‚ ; æ”¿åºœå®˜å“¡|	å…¬å‹™äººå“¡ ; å¼Šæ¡ˆ ; æ”¿å‹™å®˜ ; è¡Œæ”¿ä¸­ç«‹ ; è¼”é¸|
|0.000001024151629|	é‡å°è¡Œæ”¿é™¢é‡‘èç›£ç£ç®¡ç†å§”å“¡æœƒæå‡ºã€Œç¾é‡‘å¡å»£å‘Šæœ€æ–°è¦ç¯„ã€ï¼Œå®£å¸ƒè‡ªäº”æœˆä¸€æ—¥èµ·ï¼Œç¾é‡‘å¡æ‡‰æš«åœåœ¨é›»å­...|	æ¶ˆè²»è²¸æ¬¾ ; éŠ€è¡Œç®¡ç† | ç¾é‡‘å¡å»£å‘Š|
|0.000001019861088|	é‡å°è©é¨™é›†åœ˜çŒ–ç—ï¼Œè¡Œé¨™æ‰‹æ³•æ¨é™³å‡ºæ–°ï¼Œä»¤äººé˜²ä¸å‹é˜²ï¼Œæ“šçµ±è¨ˆç´„æœ‰å…«æˆæ°‘çœ¾æ›¾æ¥ç²è©é¨™é›†åœ˜çš„è¡Œé¨™é›»è©±...|	é›»è©± ; è©æ¬º|	è©é¨™é›†åœ˜ ; é›»è©± ; ç°¡è¨Š|

### Use End-to-End Model

```
from tensorflow import keras
model = keras.models.load_model('lour_pork_model') 
```

Step-by-step tutorial finds [here](https://github.com/davidycliao/PorkCNN/blob/main/demo-cnn-pork-barrel-classification-task.ipynb)

## Reference:

- [Yoon Kim, Convolutional Neural Networks for Sentence Classification](https://arxiv.org/abs/1408.5882)
- @gaussic's repo [text-classification-cnn-rnn](https://github.com/gaussic/text-classification-cnn-rnn)
- https://machinelearningmastery.com/start-here/#deeplearning
- Chapter 11, 13, 14 from [Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow](https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/)
